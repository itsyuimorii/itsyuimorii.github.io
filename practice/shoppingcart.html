<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>React and TypeScript Shopping Cart Application | â˜» itsyuimorii.space</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content=" ">
    
    <link rel="preload" href="/assets/css/0.styles.8f3dca9f.css" as="style"><link rel="preload" href="/assets/js/app.204ed3d4.js" as="script"><link rel="preload" href="/assets/js/2.a44fb3b0.js" as="script"><link rel="preload" href="/assets/js/1.8d37d391.js" as="script"><link rel="preload" href="/assets/js/55.a4b8b234.js" as="script"><link rel="prefetch" href="/assets/js/10.d8df69df.js"><link rel="prefetch" href="/assets/js/11.2a97faa3.js"><link rel="prefetch" href="/assets/js/12.5fd72f78.js"><link rel="prefetch" href="/assets/js/13.767d92f0.js"><link rel="prefetch" href="/assets/js/14.09112e04.js"><link rel="prefetch" href="/assets/js/15.2d87bde7.js"><link rel="prefetch" href="/assets/js/16.d6bec5e2.js"><link rel="prefetch" href="/assets/js/17.3dbcb51f.js"><link rel="prefetch" href="/assets/js/18.4c170722.js"><link rel="prefetch" href="/assets/js/19.1b72b4a4.js"><link rel="prefetch" href="/assets/js/20.9741499c.js"><link rel="prefetch" href="/assets/js/21.7f8f7869.js"><link rel="prefetch" href="/assets/js/22.3f20ce36.js"><link rel="prefetch" href="/assets/js/23.7c0322e8.js"><link rel="prefetch" href="/assets/js/24.fa4b7294.js"><link rel="prefetch" href="/assets/js/25.4b75e33e.js"><link rel="prefetch" href="/assets/js/26.6ccb7807.js"><link rel="prefetch" href="/assets/js/27.6c078df5.js"><link rel="prefetch" href="/assets/js/28.520f43fd.js"><link rel="prefetch" href="/assets/js/29.844af673.js"><link rel="prefetch" href="/assets/js/3.f8c28e7e.js"><link rel="prefetch" href="/assets/js/30.b352e55d.js"><link rel="prefetch" href="/assets/js/31.c2296a43.js"><link rel="prefetch" href="/assets/js/32.f990ea1b.js"><link rel="prefetch" href="/assets/js/33.e2f64269.js"><link rel="prefetch" href="/assets/js/34.b9fe4fba.js"><link rel="prefetch" href="/assets/js/35.6015d88a.js"><link rel="prefetch" href="/assets/js/36.2ee99065.js"><link rel="prefetch" href="/assets/js/37.9bd0a687.js"><link rel="prefetch" href="/assets/js/38.04db86c7.js"><link rel="prefetch" href="/assets/js/39.1fe91b86.js"><link rel="prefetch" href="/assets/js/4.9eb8282d.js"><link rel="prefetch" href="/assets/js/40.43f0acc3.js"><link rel="prefetch" href="/assets/js/41.7bcb3391.js"><link rel="prefetch" href="/assets/js/42.d64e546e.js"><link rel="prefetch" href="/assets/js/43.a2cbbfc3.js"><link rel="prefetch" href="/assets/js/44.0492f992.js"><link rel="prefetch" href="/assets/js/45.af66bbe7.js"><link rel="prefetch" href="/assets/js/46.c1c9a53c.js"><link rel="prefetch" href="/assets/js/47.7a2bd268.js"><link rel="prefetch" href="/assets/js/48.0376d3a5.js"><link rel="prefetch" href="/assets/js/49.60535624.js"><link rel="prefetch" href="/assets/js/5.4ceb5601.js"><link rel="prefetch" href="/assets/js/50.88e721ab.js"><link rel="prefetch" href="/assets/js/51.a1a8ca8d.js"><link rel="prefetch" href="/assets/js/52.19d2519d.js"><link rel="prefetch" href="/assets/js/53.891befed.js"><link rel="prefetch" href="/assets/js/54.b3d8b254.js"><link rel="prefetch" href="/assets/js/56.710acef5.js"><link rel="prefetch" href="/assets/js/6.cb88f024.js"><link rel="prefetch" href="/assets/js/7.0f51d652.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.8ee43d73.js">
    <link rel="stylesheet" href="/assets/css/0.styles.8f3dca9f.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">â˜» itsyuimorii.space</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="âœ¸ãƒãƒ¼ãƒˆ" class="dropdown-title"><span class="title">âœ¸ãƒãƒ¼ãƒˆ</span> <span class="arrow down"></span></button> <button type="button" aria-label="âœ¸ãƒãƒ¼ãƒˆ" class="mobile-dropdown-title"><span class="title">âœ¸ãƒãƒ¼ãƒˆ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          ã€Œå­¦ç¿’ãƒãƒ¼ãƒˆã€
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/guide/react/" class="nav-link">
  â–«ï¸ React.js
</a></li><li class="dropdown-subitem"><a href="/guide/typescript/" class="nav-link">
  â–«ï¸ Typescript
</a></li><li class="dropdown-subitem"><a href="/guide/javascript/" class="nav-link">
  â–«ï¸ Javascript
</a></li><li class="dropdown-subitem"><a href="/guide/nextjs/" class="nav-link">
  â–«ï¸ Next.js
</a></li></ul></li><li class="dropdown-item"><h4>
          ã€Œãƒ¡ãƒ¢å¸³ã€
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/memo/" class="nav-link">
  â–«ï¸ memoãƒ¡ãƒ¢
</a></li><li class="dropdown-subitem"><a href="/practice/" class="nav-link router-link-active">
  â–«ï¸ ãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="âœ¸ã™ã¹ã¦ã‚’è¨˜éŒ²ã™ã‚‹" class="dropdown-title"><span class="title">âœ¸ã™ã¹ã¦ã‚’è¨˜éŒ²ã™ã‚‹</span> <span class="arrow down"></span></button> <button type="button" aria-label="âœ¸ã™ã¹ã¦ã‚’è¨˜éŒ²ã™ã‚‹" class="mobile-dropdown-title"><span class="title">âœ¸ã™ã¹ã¦ã‚’è¨˜éŒ²ã™ã‚‹</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          ãƒ©ã‚¤ãƒ•
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/life/reading/" class="nav-link">
  èª­æ›¸ãƒ¡ãƒ¢
</a></li><li class="dropdown-subitem"><a href="/life/moment/" class="nav-link">
  ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/itsyuimorii" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="âœ¸ãƒãƒ¼ãƒˆ" class="dropdown-title"><span class="title">âœ¸ãƒãƒ¼ãƒˆ</span> <span class="arrow down"></span></button> <button type="button" aria-label="âœ¸ãƒãƒ¼ãƒˆ" class="mobile-dropdown-title"><span class="title">âœ¸ãƒãƒ¼ãƒˆ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          ã€Œå­¦ç¿’ãƒãƒ¼ãƒˆã€
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/guide/react/" class="nav-link">
  â–«ï¸ React.js
</a></li><li class="dropdown-subitem"><a href="/guide/typescript/" class="nav-link">
  â–«ï¸ Typescript
</a></li><li class="dropdown-subitem"><a href="/guide/javascript/" class="nav-link">
  â–«ï¸ Javascript
</a></li><li class="dropdown-subitem"><a href="/guide/nextjs/" class="nav-link">
  â–«ï¸ Next.js
</a></li></ul></li><li class="dropdown-item"><h4>
          ã€Œãƒ¡ãƒ¢å¸³ã€
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/memo/" class="nav-link">
  â–«ï¸ memoãƒ¡ãƒ¢
</a></li><li class="dropdown-subitem"><a href="/practice/" class="nav-link router-link-active">
  â–«ï¸ ãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="âœ¸ã™ã¹ã¦ã‚’è¨˜éŒ²ã™ã‚‹" class="dropdown-title"><span class="title">âœ¸ã™ã¹ã¦ã‚’è¨˜éŒ²ã™ã‚‹</span> <span class="arrow down"></span></button> <button type="button" aria-label="âœ¸ã™ã¹ã¦ã‚’è¨˜éŒ²ã™ã‚‹" class="mobile-dropdown-title"><span class="title">âœ¸ã™ã¹ã¦ã‚’è¨˜éŒ²ã™ã‚‹</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          ãƒ©ã‚¤ãƒ•
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/life/reading/" class="nav-link">
  èª­æ›¸ãƒ¡ãƒ¢
</a></li><li class="dropdown-subitem"><a href="/life/moment/" class="nav-link">
  ãƒ¢ãƒ¼ãƒ¡ãƒ³ãƒˆ
</a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://github.com/itsyuimorii" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/practice/" aria-current="page" class="sidebar-link">ãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</a></li><li><a href="/practice/todolist.html" class="sidebar-link">TodoList App</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/practice/todolist.html#ãƒ•ã‚šãƒ­ã‚·ã‚™ã‚§ã‚¯ãƒˆã®æ§‹æˆ" class="sidebar-link">ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ§‹æˆ</a></li><li class="sidebar-sub-header"><a href="/practice/todolist.html#tdinput-component" class="sidebar-link">TdInput Component</a></li><li class="sidebar-sub-header"><a href="/practice/todolist.html#tdlist-component" class="sidebar-link">TdList Component</a></li><li class="sidebar-sub-header"><a href="/practice/todolist.html#tditem-component" class="sidebar-link">TdItem Component</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/practice/todolist.html#å®šç¾©-inputref" class="sidebar-link">å®šç¾© inputRef</a></li><li class="sidebar-sub-header"><a href="/practice/todolist.html#å®šç¾©-itodo-æ¥å£" class="sidebar-link">å®šç¾© Itodo æ¥å£</a></li><li class="sidebar-sub-header"><a href="/practice/todolist.html#å®šç¾©-iprops-src-components-todolist-input-index-tsx" class="sidebar-link">å®šç¾© Iprops src/components/TodoList/Input/index.tsx</a></li></ul></li><li class="sidebar-sub-header"><a href="/practice/todolist.html#todolist-çˆ¶çµ„ä»¶" class="sidebar-link">TodoList çˆ¶çµ„ä»¶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/practice/todolist.html#ä½¿ç”¨-usereducer-æ›¿ä»£-usestate" class="sidebar-link">ä½¿ç”¨ useReducer æ›¿ä»£ useState</a></li><li class="sidebar-sub-header"><a href="/practice/todolist.html#åˆ†æ-1-è¦ªã‚³ãƒ³ãƒ›ã‚šãƒ¼ãƒãƒ³ãƒˆã‹ã‚™å­ã‚³ãƒ³ãƒ›ã‚šãƒ¼ãƒãƒ³ãƒˆã«æä¾›ã™ã‚‹-addtodo-é–¢æ•°ã‚’ç†è§£ã™ã‚‹ã«ã¯" class="sidebar-link">åˆ†æ 1ï¼šè¦ªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå­ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã«æä¾›ã™ã‚‹ addTodo é–¢æ•°ã‚’ç†è§£ã™ã‚‹ã«ã¯ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/practice/todolist.html#åˆ†æ-3-ä»€éº¼æ˜¯-action-creator-è¿”å›ç´”å‡½æ•¸çš„æ„æ€æ˜¯" class="sidebar-link">åˆ†æ 3 ä»€éº¼æ˜¯ action creatorï¼Ÿ è¿”å›ç´”å‡½æ•¸çš„æ„æ€æ˜¯ï¼Ÿ</a></li><li class="sidebar-sub-header"><a href="/practice/todolist.html#åˆ†æ-4-iprops" class="sidebar-link">åˆ†æ 4ï¼š Iprops</a></li><li class="sidebar-sub-header"><a href="/practice/todolist.html#iprops-interface-for-tdinput-component" class="sidebar-link">IProps Interface for TdInput Component:</a></li><li class="sidebar-sub-header"><a href="/practice/todolist.html#iprops-interface-for-tdlist-component" class="sidebar-link">IProps Interface for TdList Component:</a></li><li class="sidebar-sub-header"><a href="/practice/todolist.html#common-aspects" class="sidebar-link">Common Aspects:</a></li><li class="sidebar-sub-header"><a href="/practice/todolist.html#iprops-in-the-todolist-input-index-tsx" class="sidebar-link">IProps in the TodoList&gt;input&gt;index.tsx</a></li></ul></li></ul></li><li><a href="/practice/shoppingcart.html" aria-current="page" class="active sidebar-link">React and TypeScript Shopping Cart Application</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#ğŸ”·-cartprovider-component" class="sidebar-link">ğŸ”· CartProvider Component</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#_1-type-definitions" class="sidebar-link">1. Type Definitions</a></li><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#_2-action-types-definition" class="sidebar-link">2. Action Types Definition</a></li><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#_3-reducer-function" class="sidebar-link">3. Reducer Function</a></li><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#_4-custom-hook-usecartcontext" class="sidebar-link">4. Custom Hook: useCartContext</a></li><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#_5-react-context-and-provider" class="sidebar-link">5. React Context and Provider</a></li><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#usage-instructions" class="sidebar-link">Usage Instructions</a></li><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#ğŸ”»-cartprovider-code-review" class="sidebar-link">ğŸ”» CartProvider Code review</a></li></ul></li><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#ğŸ”·-productsprovider-component" class="sidebar-link">ğŸ”· ProductsProvider Component</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#_1-type-definitions-2" class="sidebar-link">1. Type Definitions</a></li><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#_2-initial-state" class="sidebar-link">2. Initial State</a></li><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#_3-context-type-definition" class="sidebar-link">3. Context Type Definition</a></li><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#_4-react-context-and-provider" class="sidebar-link">4. React Context and Provider</a></li><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#_5-fetching-and-updating-product-data" class="sidebar-link">5. Fetching and Updating Product Data</a></li><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#usage-instructions-2" class="sidebar-link">Usage Instructions</a></li><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#ğŸ”»-productsprovider-code-review" class="sidebar-link">ğŸ”» ProductsProvider Code review</a></li></ul></li><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#ğŸ”·-hooks-useproducts-hook" class="sidebar-link">ğŸ”· Hooks/useProducts Hook</a></li><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#ğŸ”·-hooks-usecart-hook" class="sidebar-link">ğŸ”· Hooks/useCart Hook</a></li><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#ğŸ”·-components-productlist" class="sidebar-link">ğŸ”· components/ProductList</a></li><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#ğŸ”·-components-product" class="sidebar-link">ğŸ”· components/Product</a></li><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#ãƒˆãƒ©ãƒ•ã‚™ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚¯ã‚™" class="sidebar-link">ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#â–«ï¸-usecartcontext-hooks" class="sidebar-link">â–«ï¸ useCartContext hooks</a></li><li class="sidebar-sub-header"><a href="/practice/shoppingcart.html#â–«ï¸-usecartcontexttype" class="sidebar-link">â–«ï¸ UseCartContextType</a></li></ul></li></ul></li><li><a href="/practice/github.html" class="sidebar-link">/practice/github.html</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="react-and-typescript-shopping-cart-application"><a href="#react-and-typescript-shopping-cart-application" class="header-anchor">#</a> React and TypeScript Shopping Cart Application</h1> <h2 id="ğŸ”·-cartprovider-component"><a href="#ğŸ”·-cartprovider-component" class="header-anchor">#</a> ğŸ”· CartProvider Component</h2> <blockquote><p>path: <code>src/Context/CartProvider.tsx</code></p></blockquote> <h3 id="_1-type-definitions"><a href="#_1-type-definitions" class="header-anchor">#</a> 1. Type Definitions</h3> <blockquote><p>CartItemType</p></blockquote> <p>Defines the structure of a single shopping cart item.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">CartItemType</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  sku<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  price<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  qty<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>CartStateType</p></blockquote> <p>Defines the type for the shopping cart state.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">CartStateType</span> <span class="token operator">=</span> <span class="token punctuation">{</span> cart<span class="token operator">:</span> CartItemType<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-action-types-definition"><a href="#_2-action-types-definition" class="header-anchor">#</a> 2. Action Types Definition</h3> <blockquote><p>REDUCER_ACTION_TYPE</p></blockquote> <p>An object defining various action types for updating the state.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> <span class="token constant">REDUCER_ACTION_TYPE</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token constant">ADD</span><span class="token operator">:</span> <span class="token string">&quot;ADD&quot;</span><span class="token punctuation">,</span>
  <span class="token constant">REMOVE</span><span class="token operator">:</span> <span class="token string">&quot;REMOVE&quot;</span><span class="token punctuation">,</span>
  <span class="token constant">QUANTITY</span><span class="token operator">:</span> <span class="token string">&quot;QUANTITY&quot;</span><span class="token punctuation">,</span>
  <span class="token constant">SUBMIT</span><span class="token operator">:</span> <span class="token string">&quot;SUBMIT&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>ReducerActionType</p></blockquote> <p>Extracts the type of <code>REDUCER_ACTION_TYPE</code> object.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">ReducerActionType</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> <span class="token constant">REDUCER_ACTION_TYPE</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>ReducerAction</p></blockquote> <p>Defines the structure of the action object expected by the reducer function.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">ReducerAction</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  type<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  payload<span class="token operator">?</span><span class="token operator">:</span> CartItemType<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_3-reducer-function"><a href="#_3-reducer-function" class="header-anchor">#</a> 3. Reducer Function</h3> <blockquote><p>reducer</p></blockquote> <p>A core function that handles changes in the shopping cart state.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span>state<span class="token operator">:</span> CartStateType<span class="token punctuation">,</span> action<span class="token operator">:</span> ReducerAction<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...switch case statements</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_4-custom-hook-usecartcontext"><a href="#_4-custom-hook-usecartcontext" class="header-anchor">#</a> 4. Custom Hook: useCartContext</h3> <blockquote><p>useCartContext</p></blockquote> <p>A custom React Hook providing a context related to the shopping cart.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> <span class="token function-variable function">useCartContext</span> <span class="token operator">=</span> <span class="token punctuation">(</span>initialCartState<span class="token operator">:</span> CartStateType<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...hook implementation</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_5-react-context-and-provider"><a href="#_5-react-context-and-provider" class="header-anchor">#</a> 5. React Context and Provider</h3> <blockquote><p>CartContext</p></blockquote> <p>Creates a React Context to share the shopping cart state across components.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">const</span> CartContext <span class="token operator">=</span> <span class="token generic-function"><span class="token function">createContext</span><span class="token generic class-name"><span class="token operator">&lt;</span>UseCartContextType<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
  initalCartContextState
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>CartProvider</p></blockquote> <p>A React component using <code>useCartContext</code> Hook and <code>CartContext.Provider</code> to provide the shopping cart context to the application.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">const</span> CartProvider <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token operator">:</span> ChildrenType<span class="token punctuation">)</span><span class="token operator">:</span> ReactElement <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...provider implementation</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="usage-instructions"><a href="#usage-instructions" class="header-anchor">#</a> Usage Instructions</h3> <p>Use <code>useContext(CartContext)</code> in components that need to access or modify the shopping cart state.
Example: To add an item to the cart, use <code>dispatch({ type: 'ADD', payload: newItem })</code>.</p> <h3 id="ğŸ”»-cartprovider-code-review"><a href="#ğŸ”»-cartprovider-code-review" class="header-anchor">#</a> ğŸ”» CartProvider Code review</h3> <div class="language-tsx extra-class"><pre class="language-tsx"><code>
<span class="token comment">//path: src/context/CartProvider.tsx</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> ReactElement<span class="token punctuation">,</span> createContext<span class="token punctuation">,</span> useMemo<span class="token punctuation">,</span> useReducer <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token comment">//ç”¨æ–¼æè¿°å–®å€‹è³¼ç‰©è»Šé …ç›®çš„çµæ§‹ã€‚</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">CartItemType</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
sku<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
price<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
qty<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//1. å®šç¾©è³¼ç‰©è»Šç›¸é—œçš„ TypeScript é¡å‹</span>
<span class="token comment">//å®šç¾©è³¼ç‰©è»Šç‹€æ…‹é¡å‹</span>
<span class="token comment">//å®ƒæ˜¯ä¸€å€‹åŒ…å«å–®å€‹å±¬æ€§ cart çš„å°è±¡ï¼Œè€Œ cart æ˜¯ä¸€å€‹ CartItemType[] é¡å‹çš„æ•¸çµ„ã€‚</span>
<span class="token keyword">type</span> <span class="token class-name">CartStateType</span> <span class="token operator">=</span> <span class="token punctuation">{</span> cart<span class="token operator">:</span> CartItemType<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> initialCartState<span class="token operator">:</span> CartStateType <span class="token operator">=</span> <span class="token punctuation">{</span> cart<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//2. å®šç¾©ç”¨æ–¼æ›´æ–°è³¼ç‰©è»Šç‹€æ…‹çš„ Action é¡å‹</span>
<span class="token comment">//2.1 é€™æ˜¯ä¸€å€‹å°è±¡ï¼Œå…¶ä¸­å®šç¾©äº†ç”¨æ–¼æ›´æ–°ç‹€æ…‹çš„å„ç¨® action çš„é¡å‹ã€‚å¦‚ ADDï¼ŒREMOVEï¼ŒQUANTITYï¼ŒSUBMITã€‚ é€™äº›æ˜¯ä½ å°‡åœ¨æ‡‰ç”¨ä¸­ç”¨ä¾†æè¿°ç™¼ç”Ÿçš„äº‹ä»¶çš„å¸¸é‡ã€‚</span>
<span class="token keyword">const</span> <span class="token constant">REDUCER_ACTION_TYPE</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token constant">ADD</span><span class="token operator">:</span> <span class="token string">&quot;ADD&quot;</span><span class="token punctuation">,</span>
<span class="token constant">REMOVE</span><span class="token operator">:</span> <span class="token string">&quot;REMOVE&quot;</span><span class="token punctuation">,</span>
<span class="token constant">QUANTITY</span><span class="token operator">:</span> <span class="token string">&quot;QUANTITY&quot;</span><span class="token punctuation">,</span>
<span class="token constant">SUBMIT</span><span class="token operator">:</span> <span class="token string">&quot;SUBMIT&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

 <span class="token comment">//2.2 é€šé typeof ç²å– REDUCER_ACTION_TYPE çš„å°è±¡çš„é¡å‹ï¼Œä¸¦å°‡é€™å€‹é¡å‹å°å‡ºç‚º ReducerActionTypeã€‚ é€™æ¨£åšçš„å¥½è™•æ˜¯ä½ ç²å¾—äº†ä¸€å€‹ç²¾ç¢ºçš„é¡å‹ï¼Œä»£è¡¨ REDUCER_ACTION_TYPE çš„çµæ§‹ï¼Œè€Œä¸åƒ…åƒ…æ˜¯ä¸€å€‹ç°¡å–®çš„å°è±¡ã€‚é€™åœ¨ TypeScript ä¸­æœ‰åŠ©æ–¼æé«˜é¡å‹å®‰å…¨æ€§å’Œè‡ªå‹•å®Œæˆã€‚</span>



<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">ReducerActionType</span> <span class="token operator">=</span> <span class="token keyword">typeof</span> <span class="token constant">REDUCER_ACTION_TYPE</span><span class="token punctuation">;</span>
<span class="token comment">//2.3 å®šç¾©äº†å‚³éçµ¦ reducer å‡½æ•¸çš„ action å°è±¡çš„çµæ§‹ã€‚ åŒ…å« typeï¼ˆå‹•ä½œé¡å‹ï¼‰å’Œ payloadï¼ˆé™„åŠ æ•¸æ“šï¼Œå¯é¸ï¼‰ã€‚</span>

<span class="token comment">//é€™æ˜¯å¦ä¸€å€‹ TypeScript é¡å‹å®šç¾©ï¼Œç”¨æ–¼æè¿° reducer å‡½æ•¸æœŸæœ›æ¥æ”¶çš„ action å°è±¡çš„çµæ§‹ã€‚æ¯å€‹ action éƒ½æœ‰ä¸€å€‹ type å±¬æ€§ï¼Œå®ƒæ˜¯ä¸€å€‹å­—ç¬¦ä¸²ï¼Œæ‡‰å°æ‡‰æ–¼ REDUCER_ACTION_TYPE ä¸­å®šç¾©çš„ä¸€å€‹å€¼ã€‚payload æ˜¯ä¸€å€‹å¯é¸å±¬æ€§ï¼ŒåŒ…å«äº†ä»»ä½•é™„åŠ çš„æ•¸æ“šï¼ˆåœ¨é€™ç¨®æƒ…æ³ä¸‹æ˜¯ CartItemTypeï¼‰ã€‚</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">ReducerAction</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
type<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
payload<span class="token operator">?</span><span class="token operator">:</span> CartItemType<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//3. Reducer å‡½æ•¸</span>
<span class="token comment">//3.1 Reducer Function (reducer): é€™æ˜¯æ ¸å¿ƒåŠŸèƒ½ä¹‹ä¸€ï¼Œç”¨æ–¼è™•ç†è³¼ç‰©è»Šç‹€æ…‹çš„è®ŠåŒ–ã€‚å®ƒæ ¹æ“šä¸åŒçš„å‹•ä½œï¼ˆæ·»åŠ ã€ç§»é™¤ã€ä¿®æ”¹æ•¸é‡ã€æäº¤ï¼‰ä¾†æ›´æ–°ç‹€æ…‹ã€‚é€™ç¨®æ–¹å¼èƒ½å¤ é›†ä¸­ç®¡ç†ç‹€æ…‹çš„è®Šæ›´ï¼Œæ˜¯ Redux æ¶æ§‹ä¸­çš„ä¸€éƒ¨åˆ†ã€‚</span>
<span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span>state<span class="token operator">:</span> CartStateType<span class="token punctuation">,</span> action<span class="token operator">:</span> ReducerAction<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token keyword">switch</span> <span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">case</span> <span class="token constant">REDUCER_ACTION_TYPE</span><span class="token punctuation">.</span><span class="token constant">ADD</span><span class="token operator">:</span> <span class="token punctuation">{</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>action<span class="token punctuation">.</span>payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;action.payload missing in ADD action&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> sku<span class="token punctuation">,</span> name<span class="token punctuation">,</span> price <span class="token punctuation">}</span> <span class="token operator">=</span> action<span class="token punctuation">.</span>payload<span class="token punctuation">;</span>
<span class="token comment">//å¦‚æœ sku ä¸ç­‰äºç»™å®šçš„å€¼ï¼Œè¿™ä¸ªå…ƒç´ å°±ä¼šè¢«ä¿ç•™åœ¨æ–°æ•°ç»„ filteredCart ä¸­ï¼Œå¦åˆ™å°†è¢«æ’é™¤ã€‚</span>
<span class="token keyword">const</span> filteredCart<span class="token operator">:</span> CartItemType<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> state<span class="token punctuation">.</span>cart<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>
<span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>sku <span class="token operator">!==</span> sku
<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">const</span> itemExisted<span class="token operator">:</span> CartItemType <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token operator">=</span> state<span class="token punctuation">.</span>cart<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
        <span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>sku <span class="token operator">===</span> sku
      <span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">const</span> qty<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> itemExisted <span class="token operator">?</span> itemExisted<span class="token punctuation">.</span>qty <span class="token operator">+</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> cart<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>filteredCart<span class="token punctuation">,</span> <span class="token punctuation">{</span> sku<span class="token punctuation">,</span> name<span class="token punctuation">,</span> price<span class="token punctuation">,</span> qty <span class="token punctuation">}</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">case</span> <span class="token constant">REDUCER_ACTION_TYPE</span><span class="token punctuation">.</span><span class="token constant">REMOVE</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>action<span class="token punctuation">.</span>payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;action.payload missing in REMOVE action&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> sku <span class="token punctuation">}</span> <span class="token operator">=</span> action<span class="token punctuation">.</span>payload<span class="token punctuation">;</span>

      <span class="token keyword">const</span> filteredCart<span class="token operator">:</span> CartItemType<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> state<span class="token punctuation">.</span>cart<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>
        <span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>sku <span class="token operator">!==</span> sku
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> cart<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>filteredCart<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//ç„¶åï¼Œå®ƒåˆ›å»ºä¸€ä¸ªåä¸º updatedItem çš„å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ˜¯è´­ç‰©è½¦ä¸­ç°æœ‰å•†å“çš„å‰¯æœ¬ï¼Œä½†å…·æœ‰æ›´æ–°çš„ qtyã€‚æœ€åï¼Œå®ƒåˆ›å»ºä¸€ä¸ªåä¸º filteredCart çš„æ–°æ•°ç»„ï¼Œå…¶ä¸­åŒ…å«æ‰€æœ‰å…¶ä»–å•†å“ï¼Œä½†ä¸åŒ…æ‹¬è¦æ›´æ–°çš„å•†å“ã€‚</span>
    <span class="token keyword">case</span> <span class="token constant">REDUCER_ACTION_TYPE</span><span class="token punctuation">.</span><span class="token constant">QUANTITY</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>action<span class="token punctuation">.</span>payload<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;action.payload missing in QUANTITY action&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> sku<span class="token punctuation">,</span> qty <span class="token punctuation">}</span> <span class="token operator">=</span> action<span class="token punctuation">.</span>payload<span class="token punctuation">;</span>

      <span class="token keyword">const</span> itemExists<span class="token operator">:</span> CartItemType <span class="token operator">|</span> <span class="token keyword">undefined</span> <span class="token operator">=</span> state<span class="token punctuation">.</span>cart<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>
        <span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>sku <span class="token operator">===</span> sku
      <span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>itemExists<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;item must exist in order to update quantity&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// åˆ›å»ºä¸€ä¸ªæ›´æ–°åçš„å•†å“å¯¹è±¡</span>
      <span class="token keyword">const</span> updatedItem<span class="token operator">:</span> CartItemType <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>itemExists<span class="token punctuation">,</span> qty <span class="token punctuation">}</span><span class="token punctuation">;</span>

      <span class="token comment">// åˆ›å»ºä¸€ä¸ªæ–°çš„è´­ç‰©è½¦æ•°ç»„ï¼Œå…¶ä¸­åŒ…æ‹¬æ›´æ–°åçš„å•†å“</span>
      <span class="token keyword">const</span> filteredCart<span class="token operator">:</span> CartItemType<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> state<span class="token punctuation">.</span>cart<span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>
        <span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>sku <span class="token operator">!==</span> sku
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> cart<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>filteredCart<span class="token punctuation">,</span> updatedItem<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token comment">// map æ–¹æ³• ï¼š åˆ›å»ºä¸€ä¸ªæ–°çš„è´­ç‰©è½¦æ•°ç»„ï¼Œå…¶ä¸­åŒ…æ‹¬æ›´æ–°åçš„å•†å“</span>
      <span class="token comment">// const filteredCart: CartItemType[] = state.cart.map((item) =&gt;</span>
      <span class="token comment">// item.sku === sku ? updatedItem : item</span>
      <span class="token comment">// );</span>
      <span class="token comment">// è¿”å›æ›´æ–°åçš„è´­ç‰©è½¦çŠ¶æ€</span>
      <span class="token comment">// return { ...state, cart: filteredCart };</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">case</span> <span class="token constant">REDUCER_ACTION_TYPE</span><span class="token punctuation">.</span><span class="token constant">SUBMIT</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token operator">...</span>state<span class="token punctuation">,</span> cart<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Unidentified reducer action type&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 4. è‡ªå®šç¾© Hookï¼šuseCartContext</span>

<span class="token operator">/</span>\<span class="token operator">*</span>\<span class="token operator">*</span>
<span class="token operator">*</span>ä½¿ç”¨ useReducer ä¾†ç®¡ç†è³¼ç‰©è»Šç‹€æ…‹ã€‚
<span class="token operator">*</span>ç”¨ useMemo ä¾†ç·©å­˜è¨ˆç®—çµæœï¼ˆ<span class="token constant">REDUCER_ACTIONS</span>ï¼‰ã€‚
<span class="token operator">*</span>è¨ˆç®—è³¼ç‰©è»Šçš„ç¸½æ•¸é‡å’Œç¸½åƒ¹æ ¼ã€‚
<span class="token operator">*</span>å°è³¼ç‰©è»Šä¸­çš„å•†å“é€²è¡Œæ’åºã€‚\<span class="token operator">*</span><span class="token operator">/</span>

<span class="token comment">//useCartContext æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„ React Hookï¼Œå®ƒçš„ä½œç”¨æ˜¯ä¸ºä½ çš„åº”ç”¨ç¨‹åºæä¾›ä¸€ä¸ªä¸è´­ç‰©è½¦ç›¸å…³çš„ä¸Šä¸‹æ–‡ã€‚è¿™ä¸ªä¸Šä¸‹æ–‡åŒ…å«äº†è´­ç‰©è½¦çš„çŠ¶æ€ä»¥åŠä¸è´­ç‰©è½¦æ“ä½œç›¸å…³çš„å‡½æ•°ï¼Œä¾‹å¦‚æ·»åŠ å•†å“ã€åˆ é™¤å•†å“ã€æ›´æ–°å•†å“æ•°é‡ç­‰ã€‚</span>

<span class="token comment">//è‡ªå®šç¾© Hook å¦‚ useCartContext è¢«ç”¨ä¾†å°è£å’Œå…±äº«é‚è¼¯ï¼Œç›¸åŒçš„é‚è¼¯å¯ä»¥åœ¨æ‡‰ç”¨ä¸­çš„å¤šå€‹åœ°æ–¹ä½¿ç”¨ï¼Œè€Œä¸å¿…é‡è¤‡ç›¸åŒçš„ä»£ç¢¼ã€‚ useCartContext æ¥å—ä¸€ä¸ªå‚æ•° initialCartStateï¼Œå®ƒæ˜¯è´­ç‰©è½¦çš„åˆå§‹çŠ¶æ€ï¼ŒåŒ…å«ä¸€ä¸ªç©ºçš„è´­ç‰©è½¦æ•°ç»„ã€‚</span>
<span class="token keyword">const</span> <span class="token function-variable function">useCartContext</span> <span class="token operator">=</span> <span class="token punctuation">(</span>initialCartState<span class="token operator">:</span> CartStateType<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> initialCartState<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//useMemo ä¸»è¦ç”¨äºç¼“å­˜è®¡ç®—ç»“æœï¼Œå¹¶åœ¨ä¾èµ–é¡¹ï¼ˆdependenciesï¼‰å‘ç”Ÿå˜åŒ–æ—¶é‡æ–°è®¡ç®—ã€‚</span>
<span class="token keyword">const</span> <span class="token constant">REDUCER_ACTIONS</span> <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token keyword">return</span> <span class="token constant">REDUCER_ACTION_TYPE</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> totalItems <span class="token operator">=</span> state<span class="token punctuation">.</span>cart<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>previousValue<span class="token punctuation">,</span> cartItem<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token keyword">return</span> previousValue <span class="token operator">+</span> cartItem<span class="token punctuation">.</span>qty<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> totalPrice <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl</span><span class="token punctuation">.</span><span class="token function">NumberFormat</span><span class="token punctuation">(</span><span class="token string">&quot;en-US&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
style<span class="token operator">:</span> <span class="token string">&quot;currency&quot;</span><span class="token punctuation">,</span>
currency<span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>
state<span class="token punctuation">.</span>cart<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>previousValue<span class="token punctuation">,</span> cartItem<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token keyword">return</span> previousValue <span class="token operator">+</span> cartItem<span class="token punctuation">.</span>qty \<span class="token operator">*</span> cartItem<span class="token punctuation">.</span>price<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯å¯¹è´­ç‰©è½¦ä¸­çš„å•†å“è¿›è¡Œæ’åºï¼Œæ’åºçš„è§„åˆ™æ˜¯æŒ‰ç…§å•†å“çš„ sku å±æ€§çš„åå››ä½æ•°å­—è¿›è¡Œå‡åºæ’åºã€‚</span>
<span class="token keyword">const</span> cart <span class="token operator">=</span> state<span class="token punctuation">.</span>cart<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token comment">//åˆ†åˆ«æå–äº†å•†å“ a å’Œ b çš„ sku å±æ€§çš„åå››ä½æ•°å­—éƒ¨åˆ†ã€‚è¿™äº›æ•°å­—ä¼šè¢«è½¬æ¢æˆæ•°å€¼ç±»å‹ã€‚</span>
<span class="token keyword">const</span> itemA <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>sku<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> itemB <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>sku<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//è¡¨ç¤ºæ ¹æ®æå–å‡ºçš„æ•°å­—è¿›è¡Œå‡åºæ’åºï¼Œå³å¦‚æœ itemA å°äº itemBï¼Œè¿”å›è´Ÿæ•°ï¼›å¦‚æœ itemA ç­‰äº itemBï¼Œè¿”å›é›¶ï¼›å¦‚æœ itemA å¤§äº itemBï¼Œè¿”å›æ­£æ•°ã€‚</span>
<span class="token keyword">return</span> itemA <span class="token operator">-</span> itemB<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">return</span> <span class="token punctuation">{</span> dispatch<span class="token punctuation">,</span> <span class="token constant">REDUCER_ACTIONS</span><span class="token punctuation">,</span> totalPrice<span class="token punctuation">,</span> totalItems<span class="token punctuation">,</span> cart <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//è¿™é‡Œä½¿ç”¨äº† TypeScript çš„ ReturnType å·¥å…·ç±»å‹ï¼Œå®ƒç”¨äºè·å–ä¸€ä¸ªå‡½æ•°è¿”å›å€¼çš„ç±»å‹ ã€‚typeof useCartContext è¡¨ç¤ºè·å– useCartContext å‡½æ•°çš„ç±»å‹ï¼ŒReturnType&lt;typeof useCartContext&gt; åˆ™æ˜¯è¿™ä¸ªå‡½æ•°è¿”å›å€¼çš„ç±»å‹ã€‚è¿™ä¸ªç±»å‹è¢«ç”¨ä½œä¸‹é¢ CartContext çš„ç±»å‹å‚æ•°ã€‚</span>

<span class="token comment">//è¿”å›å€¼æ˜¯ä»€ä¹ˆ : useCartContext Hook çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†ä¸è´­ç‰©è½¦ç›¸å…³çš„æ•°æ®å’Œå‡½æ•°ã€‚è¿™é€šå¸¸åŒ…æ‹¬è´­ç‰©è½¦çš„çŠ¶æ€ï¼ˆå¦‚å•†å“åˆ—è¡¨ã€æ€»ä»·ç­‰ï¼‰ä»¥åŠç”¨äºæ›´æ–°è¿™äº›çŠ¶æ€çš„æ–¹æ³•ï¼ˆå¦‚ dispatch æ–¹æ³•ï¼‰ã€‚</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">UseCartContextType</span> <span class="token operator">=</span> ReturnType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> useCartContext<span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token comment">//Context and Provider (CartContext å’Œ CartProvider): é€™å€‹éƒ¨åˆ†å‰µå»ºäº†ä¸€å€‹ React Context ä¾†è·¨çµ„ä»¶å…±äº«è³¼ç‰©è»Šçš„ç‹€æ…‹å’Œæ“ä½œã€‚CartProvider çµ„ä»¶å‰‡å°‡é€™å€‹ä¸Šä¸‹æ–‡æ‡‰ç”¨æ–¼æ‡‰ç”¨ç¨‹åºçš„æ ¹çµ„ä»¶ã€‚</span>

<span class="token comment">//è¿™é‡Œå®šä¹‰äº†åˆå§‹çš„ä¸Šä¸‹æ–‡çŠ¶æ€ã€‚initalCartContextState ç¬¦åˆ UseCartContextType ç±»å‹ï¼ŒåŒ…å«äº† dispatch å‡½æ•°ã€REDUCER_ACTIONS å¸¸é‡ã€ä»¥åŠä¸€äº›è´­ç‰©è½¦ç›¸å…³çš„çŠ¶æ€å¦‚ totalItemsã€totalPrice å’Œ cartã€‚dispatch å‡½æ•°æ˜¯ä¸€ä¸ªç©ºå‡½æ•°ï¼Œè¡¨ç¤ºåœ¨é»˜è®¤æƒ…å†µä¸‹ä¸æ‰§è¡Œä»»ä½•æ“ä½œã€‚</span>
<span class="token keyword">const</span> initalCartContextState<span class="token operator">:</span> UseCartContextType <span class="token operator">=</span> <span class="token punctuation">{</span>
<span class="token function-variable function">dispatch</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token constant">REDUCER_ACTIONS</span><span class="token operator">:</span> <span class="token constant">REDUCER_ACTION_TYPE</span><span class="token punctuation">,</span>
totalItems<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
totalPrice<span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>
cart<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//5. React Context å’Œ Provider</span>

<span class="token comment">// å‰µå»ºä¸€å€‹ React Contextï¼Œå…è¨±è·¨çµ„ä»¶å…±äº«è³¼ç‰©è»Šç‹€æ…‹ã€‚ ç”¨æ–¼åœ¨æ‡‰ç”¨ç¨‹åºä¸­æä¾›è³¼ç‰©è»Šçš„ç‹€æ…‹å’Œæ“ä½œã€‚å…¶ä»–çµ„ä»¶å¯ä»¥ä½¿ç”¨é€™å€‹ Context ä¾†è¨ªå•è³¼ç‰©è»Šçš„ç‹€æ…‹ã€‚</span>
<span class="token comment">//const SomeContext = createContext(defaultValue)</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> CartContext <span class="token operator">=</span> <span class="token generic-function"><span class="token function">createContext</span><span class="token generic class-name"><span class="token operator">&lt;</span>UseCartContextType<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>
initalCartContextState
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">ChildrenType</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
children<span class="token operator">?</span><span class="token operator">:</span> ReactElement <span class="token operator">|</span> ReactElement<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//ä½¿ç”¨ CartContext.Provider ä¾†å°‡ useCartContext çš„è¿”å›å€¼ä½œç‚ºä¸Šä¸‹æ–‡å€¼æä¾›çµ¦å…¶å­çµ„ä»¶ã€‚ CartProvider çµ„ä»¶ï¼šé€™æ˜¯ä¸€å€‹ React çµ„ä»¶ï¼Œå®ƒä½¿ç”¨ useCartContext Hook ä¸¦é€šé CartContext.Provider æä¾›è³¼ç‰©è»Šä¸Šä¸‹æ–‡çµ¦æ‡‰ç”¨ç¨‹åºã€‚å®ƒåŒ…è£äº†æ‡‰ç”¨ç¨‹åºçš„æ ¹çµ„ä»¶ï¼Œä½¿è³¼ç‰©è»Šä¸Šä¸‹æ–‡å°æ•´å€‹æ‡‰ç”¨ç¨‹åºå¯ç”¨ã€‚</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> CartProvider <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token operator">:</span> ChildrenType<span class="token punctuation">)</span><span class="token operator">:</span> ReactElement <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
<span class="token keyword">return</span> <span class="token punctuation">(</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">CartContext.Provider</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token function">useCartContext</span><span class="token punctuation">(</span>initialCartState<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">CartContext.Provider</span></span><span class="token punctuation">&gt;</span></span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">//ä½¿ç”¨ Custom Hook å’Œ Context:</span>

<span class="token comment">//åœ¨éœ€è¦è¨ªå•æˆ–ä¿®æ”¹è³¼ç‰©è»Šç‹€æ…‹çš„çµ„ä»¶ä¸­ï¼Œä½¿ç”¨ useContext(CartContext) ä¾†ç²å–è³¼ç‰©è»Šçš„ç‹€æ…‹å’Œ dispatch å‡½æ•¸ã€‚ä¾‹å¦‚ï¼Œå¦‚æœéœ€è¦å‘è³¼ç‰©è»Šä¸­æ·»åŠ ä¸€å€‹å•†å“ï¼Œå¯ä»¥ä½¿ç”¨ dispatch({ type: 'ADD', payload: newItem })ã€‚</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> CartContext<span class="token punctuation">;</span>

<span class="token operator">/</span>_ ä½¿ç”¨èªªæ˜
åœ¨éœ€è¦è¨ªå•æˆ–ä¿®æ”¹è³¼ç‰©è»Šç‹€æ…‹çš„çµ„ä»¶ä¸­ï¼Œä½¿ç”¨ <span class="token function">useContext</span><span class="token punctuation">(</span>CartContext<span class="token punctuation">)</span> ä¾†ç²å–è³¼ç‰©è»Šçš„ç‹€æ…‹å’Œ dispatch å‡½æ•¸ã€‚
ä¾‹å¦‚ï¼Œæ·»åŠ å•†å“åˆ°è³¼ç‰©è»Šå¯ä»¥ä½¿ç”¨ <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token string">'ADD'</span><span class="token punctuation">,</span> payload<span class="token operator">:</span> newItem <span class="token punctuation">}</span><span class="token punctuation">)</span>ã€‚ _<span class="token operator">/</span>

</code></pre></div><h2 id="ğŸ”·-productsprovider-component"><a href="#ğŸ”·-productsprovider-component" class="header-anchor">#</a> ğŸ”· ProductsProvider Component</h2> <blockquote><p>path: <code>src/Context/ProductsProvider.tsx</code></p></blockquote> <h3 id="_1-type-definitions-2"><a href="#_1-type-definitions-2" class="header-anchor">#</a> 1. Type Definitions</h3> <blockquote><p>ProductType</p></blockquote> <p>Defines the structure of a product.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">ProductType</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  sku<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  price<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_2-initial-state"><a href="#_2-initial-state" class="header-anchor">#</a> 2. Initial State</h3> <blockquote><p>initialState</p></blockquote> <p>An array that holds the initial state of the product list.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> initialState<span class="token operator">:</span> ProductType<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_3-context-type-definition"><a href="#_3-context-type-definition" class="header-anchor">#</a> 3. Context Type Definition</h3> <blockquote><p>UseProductsContextType</p></blockquote> <p>Defines the shape of the context used for managing product information.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">UseProductsContextType</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  products<span class="token operator">:</span> ProductType<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_4-react-context-and-provider"><a href="#_4-react-context-and-provider" class="header-anchor">#</a> 4. React Context and Provider</h3> <blockquote><p>ProductsContext</p></blockquote> <p>Creates a React Context for sharing and managing product information globally.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">const</span> ProductsContext <span class="token operator">=</span>
  <span class="token generic-function"><span class="token function">createContext</span><span class="token generic class-name"><span class="token operator">&lt;</span>UseProductsContextType<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>initialContextState<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>ProductsProvider</p></blockquote> <p>A React component that provides the product context to the application using the <code>ProductsContext.Provider</code>.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">export</span> <span class="token keyword">const</span> ProductsProvider <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token operator">:</span> ChildrenType<span class="token punctuation">)</span><span class="token operator">:</span> ReactElement <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...provider implementation</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="_5-fetching-and-updating-product-data"><a href="#_5-fetching-and-updating-product-data" class="header-anchor">#</a> 5. Fetching and Updating Product Data</h3> <blockquote><p>useEffect Hook</p></blockquote> <p>Fetches product data from an external source and updates the state.</p> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// Function to fetch products and error handling</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="usage-instructions-2"><a href="#usage-instructions-2" class="header-anchor">#</a> Usage Instructions</h3> <p>Use <code>useContext(ProductsContext)</code> in components that need to access or modify the product information.
Example: To access the list of products, use <code>const { products } = useContext(ProductsContext)</code>.</p> <p>This Markdown note provides a structured overview of your React and TypeScript product management application, outlining type definitions, initial state, context and provider, along with instructions for fetching and updating product data.</p> <h3 id="ğŸ”»-productsprovider-code-review"><a href="#ğŸ”»-productsprovider-code-review" class="header-anchor">#</a> ğŸ”» ProductsProvider Code review</h3> <div class="language-tsx extra-class"><pre class="language-tsx"><code>
<span class="token comment">////è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªåä¸º ProductType çš„ TypeScript</span>
ç±»å‹ï¼Œè¯¥ç±»å‹æè¿°äº†äº§å“çš„ç»“æ„ï¼ŒåŒ…æ‹¬skuï¼ˆåº“å­˜å•ä½ï¼‰ã€nameï¼ˆåç§°ï¼‰å’Œpriceï¼ˆä»·æ ¼ï¼‰ç­‰å±æ€§ã€‚
<span class="token operator">...</span>


<span class="token keyword">import</span> <span class="token punctuation">{</span> ReactElement<span class="token punctuation">,</span> createContext<span class="token punctuation">,</span> useState<span class="token punctuation">,</span> useEffect <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">ProductType</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  sku<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  price<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">//const initState: ProductType[] = []</span>



<span class="token keyword">const</span> initialState<span class="token operator">:</span> ProductType<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

 <span class="token comment">//è¿™é‡Œå®šä¹‰äº†ä¸€ä¸ªåä¸º initStateçš„å¸¸é‡ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†ä¸€äº›äº§å“å¯¹è±¡ã€‚è¿™ä¸ªæ•°ç»„é€šå¸¸ç”¨äºåˆå§‹åŒ–åº”ç”¨ç¨‹åºçš„çŠ¶æ€ï¼Œå¯ä»¥åœ¨Reactçš„ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨ã€‚</span>

<span class="token comment">// export const initialState: ProductType[] = [</span>
<span class="token comment">//   {</span>
<span class="token comment">//     sku: &quot;item0001&quot;,</span>
<span class="token comment">//     name: &quot;Widget&quot;,</span>
<span class="token comment">//     price: 9.99,</span>
<span class="token comment">//   },</span>
<span class="token comment">//   {</span>
<span class="token comment">//     sku: &quot;item0002&quot;,</span>
<span class="token comment">//     name: &quot;Premium Widget&quot;,</span>
<span class="token comment">//     price: 19.99,</span>
<span class="token comment">//   },</span>
<span class="token comment">//   {</span>
<span class="token comment">//     sku: &quot;item0003&quot;,</span>
<span class="token comment">//     name: &quot;Deluxe Widget&quot;,</span>
<span class="token comment">//     price: 29.99,</span>
<span class="token comment">//   },</span>
<span class="token comment">// ];</span>

<span class="token comment">//å®ƒæè¿°äº†ä¸€ä¸ªç”¨äºç®¡ç†äº§å“ä¿¡æ¯çš„ä¸Šä¸‹æ–‡çš„å½¢çŠ¶ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒåŒ…å«ä¸€ä¸ªå±æ€§(object) productsï¼Œå…¶å€¼æ˜¯ä¸€ä¸ª ProductType ç±»å‹çš„æ•°ç»„ï¼Œç”¨äºå­˜å‚¨äº§å“ä¿¡æ¯ã€‚</span>
<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">UseProductsContextType</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  products<span class="token operator">:</span> ProductType<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> initialContextState<span class="token operator">:</span> UseProductsContextType <span class="token operator">=</span> <span class="token punctuation">{</span>
  products<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">//æœ€åï¼Œå®ƒåˆ›å»ºäº†ä¸€ä¸ªåä¸º ProductsContext çš„ä¸Šä¸‹æ–‡å¯¹è±¡ï¼Œä½¿ç”¨äº†ä¹‹å‰å®šä¹‰çš„ UseProductsContextType ç±»å‹ä½œä¸ºæ³›å‹å‚æ•°ï¼Œå¹¶å°†åˆå§‹çŠ¶æ…‹initialContextStateä¼ é€’ç»™createContextå‡½æ•°ã€‚è¿™ä¸ªä¸Šä¸‹æ–‡å¯¹è±¡å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­ä½¿ç”¨ï¼Œç”¨äºå…±äº«å’Œç®¡ç†äº§å“ä¿¡æ¯çš„å…¨å±€çŠ¶æ€ã€‚</span>

<span class="token keyword">type</span> <span class="token class-name">ChildrenType</span> <span class="token operator">=</span> <span class="token punctuation">{</span> children<span class="token operator">?</span><span class="token operator">:</span> ReactElement <span class="token operator">|</span> ReactElement<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> ProductsContext <span class="token operator">=</span>
  <span class="token generic-function"><span class="token function">createContext</span><span class="token generic class-name"><span class="token operator">&lt;</span>UseProductsContextType<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>initialContextState<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> ProductsProvider <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> children <span class="token punctuation">}</span><span class="token operator">:</span> ChildrenType<span class="token punctuation">)</span><span class="token operator">:</span> ReactElement <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>products<span class="token punctuation">,</span> setProducts<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token generic-function"><span class="token function">useState</span><span class="token generic class-name"><span class="token operator">&lt;</span>ProductType<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>initialState<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> fetchProducts <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>ProductType<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">&gt;</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">&quot;http://localhost:3500/products&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>res<span class="token punctuation">.</span>ok<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Network response was not ok&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">const</span> data<span class="token operator">:</span> ProductType<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">await</span> res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> data<span class="token punctuation">;</span> <span class="token comment">// è¿”å›äº§å“æ•°æ®</span>
      <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">(</span>error <span class="token keyword">as</span> Error<span class="token punctuation">)</span><span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// ä½¿ç”¨ç±»å‹æ–­è¨€å°† error æ ‡è®°ä¸º Error ç±»å‹</span>
        <span class="token keyword">throw</span> error<span class="token punctuation">;</span> <span class="token comment">// æŠ›å‡ºé”™è¯¯ï¼Œä½¿å¤–éƒ¨å¯ä»¥æ•è·</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token function">fetchProducts</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">setProducts</span><span class="token punctuation">(</span>products<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token comment">// eslint-disable-next-line @typescript-eslint/no-unused-vars</span>
      <span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// åœ¨æ­¤å¤„å¯ä»¥è¿›ä¸€æ­¥å¤„ç†é”™è¯¯ï¼Œä¾‹å¦‚æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">ProductsContext.Provider</span></span> <span class="token attr-name">value</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> products <span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token punctuation">{</span>children<span class="token punctuation">}</span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span><span class="token class-name">ProductsContext.Provider</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> ProductsContext<span class="token punctuation">;</span>
</code></pre></div><p><code>ProductType[]</code>æ˜¯ä¸€ä¸ªè¡¨ç¤ºäº§å“æ•°ç»„çš„ç±»å‹å®šä¹‰ã€‚è€Œ <code>UseProductContextType</code>æ˜¯å¦ä¸€ä¸ªç±»å‹å®šä¹‰ï¼Œå®ƒå®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡åŒ…å«äº†ä¸€ä¸ªåä¸º<code>products</code>çš„å­—æ®µï¼Œå…¶ç±»å‹ä¸º <code>ProductType[]</code>ã€‚</p> <h2 id="ğŸ”·-hooks-useproducts-hook"><a href="#ğŸ”·-hooks-useproducts-hook" class="header-anchor">#</a> ğŸ”· Hooks/useProducts Hook</h2> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ProductsContext <span class="token keyword">from</span> <span class="token string">&quot;../context/ProductsProvider&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UseProductsContextType <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../context/ProductsProvider&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> useProducts <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> UseProductsContextType <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">useContext</span><span class="token punctuation">(</span>ProductsContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useProducts<span class="token punctuation">;</span>
</code></pre></div><h2 id="ğŸ”·-hooks-usecart-hook"><a href="#ğŸ”·-hooks-usecart-hook" class="header-anchor">#</a> ğŸ”· Hooks/useCart Hook</h2> <blockquote><p>å®ƒçš„ä½œç”¨æ˜¯ç®€åŒ–äº†åœ¨ç»„ä»¶ä¸­ä½¿ç”¨è´­ç‰©è½¦ä¸Šä¸‹æ–‡ï¼ˆCartContextï¼‰çš„è¿‡ç¨‹ã€‚è¿™ä¸ª Hook è¿”å›äº† CartContext çš„å€¼ï¼Œä½¿å¾—åœ¨ç»„ä»¶ä¸­è®¿é—®è´­ç‰©è½¦æ•°æ®å’Œæ“ä½œæ›´åŠ ç›´è§‚å’Œä¾¿æ·ã€‚è¿™ç§æ¨¡å¼éå¸¸é€‚ç”¨äºå°†ä¸Šä¸‹æ–‡çš„é€»è¾‘å°è£…èµ·æ¥ï¼Œä»¥ä¾¿åœ¨å¤šä¸ªç»„ä»¶ä¸­é‡ç”¨ã€‚</p></blockquote> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> useContext <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> CartContext <span class="token keyword">from</span> <span class="token string">&quot;../context/CartProvider&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UseCartContextType <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../context/CartProvider&quot;</span><span class="token punctuation">;</span>
<span class="token comment">//é€šè¿‡æŒ‡å®šè¿”å›ç±»å‹ä¸º UseCartContextTypeï¼Œè¿™ä¸ª Hook çš„ä½¿ç”¨è€…å¯ä»¥å¾—åˆ°å…³äºè¿”å›å€¼çš„ç±»å‹æç¤ºå’Œæ ¡éªŒã€‚</span>
<span class="token keyword">const</span> useCart <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> UseCartContextType <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token function">useContext</span><span class="token punctuation">(</span>CartContext<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> useCart<span class="token punctuation">;</span>
</code></pre></div><hr> <h2 id="ğŸ”·-components-productlist"><a href="#ğŸ”·-components-productlist" class="header-anchor">#</a> ğŸ”· components/ProductList</h2> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ReactElement <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> useCart <span class="token keyword">from</span> <span class="token string">&quot;../hooks/useCart&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> useProdudcts <span class="token keyword">from</span> <span class="token string">&quot;../hooks/useProducts&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> Product <span class="token keyword">from</span> <span class="token string">&quot;./Product&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">ProductList</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> dispatch<span class="token punctuation">,</span> <span class="token constant">REDUCER_ACTIONS</span><span class="token punctuation">,</span> cart <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useCart</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> products <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useProdudcts</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//ä½¿ç”¨ some æ–¹æ³•æª¢æŸ¥ï¼šå…·é«”åœ°ï¼ŒinCart çš„å€¼æ˜¯é€šéæª¢æŸ¥è³¼ç‰©è»Šï¼ˆcartï¼‰ä¸­æ˜¯å¦å­˜åœ¨å…·æœ‰ç›¸åŒ sku å€¼çš„ç”¢å“ä¾†ç¢ºå®šçš„ã€‚é€™é€šéä½¿ç”¨ Array.prototype.some æ–¹æ³•å¯¦ç¾ï¼Œé€™å€‹æ–¹æ³•æœƒæ¸¬è©¦é™£åˆ—ä¸­æ˜¯å¦è‡³å°‘æœ‰ä¸€å€‹å…ƒç´ æ»¿è¶³æä¾›çš„å‡½æ•¸ã€‚å¦‚æœæ»¿è¶³æ¢ä»¶ï¼ˆå³è³¼ç‰©è»Šä¸­å·²æœ‰ç›¸åŒ sku çš„ç”¢å“ï¼‰ï¼Œå‰‡ inCart ç‚º trueï¼›å¦å‰‡ï¼Œç‚º falseã€‚</span>

  <span class="token keyword">let</span> pageContent<span class="token operator">:</span> ReactElement <span class="token operator">|</span> ReactElement<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Loading...</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>products<span class="token operator">?.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    pageContent <span class="token operator">=</span> products<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>product<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> inCart<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> cart<span class="token punctuation">.</span><span class="token function">some</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> item<span class="token punctuation">.</span>sku <span class="token operator">===</span> product<span class="token punctuation">.</span>sku<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span><span class="token class-name">Product</span></span>
          <span class="token attr-name">key</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>product<span class="token punctuation">.</span>sku<span class="token punctuation">}</span></span>
          <span class="token attr-name">product</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>product<span class="token punctuation">}</span></span>
          <span class="token attr-name">dispatch</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>dispatch<span class="token punctuation">}</span></span>
          <span class="token attr-name">REDUCER_ACTIONS</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span><span class="token constant">REDUCER_ACTIONS</span><span class="token punctuation">}</span></span>
          <span class="token attr-name">inCart</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>inCart<span class="token punctuation">}</span></span>
        <span class="token punctuation">/&gt;</span></span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">const</span> content <span class="token operator">=</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main main--products<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>pageContent<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> content<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> ProductList<span class="token punctuation">;</span>
</code></pre></div><h2 id="ğŸ”·-components-product"><a href="#ğŸ”·-components-product" class="header-anchor">#</a> ğŸ”· components/Product</h2> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token comment">// å¼•å…¥æ‰€éœ€çš„ä¾è³´å’Œé¡å‹</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ProductType <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../context/ProductsProvider&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ReducerActionType<span class="token punctuation">,</span> ReducerAction <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;../context/CartProvider&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ReactElement<span class="token punctuation">,</span> memo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// å®šç¾© PropsTypeï¼Œç”¨æ–¼æè¿° Product çµ„ä»¶çš„å±¬æ€§</span>
<span class="token keyword">type</span> <span class="token class-name">PropsType</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  product<span class="token operator">:</span> ProductType<span class="token punctuation">;</span> <span class="token comment">// ç”¢å“ä¿¡æ¯</span>
  dispatch<span class="token operator">:</span> React<span class="token punctuation">.</span>Dispatch<span class="token operator">&lt;</span>ReducerAction<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// è³¼ç‰©è»Šæ“ä½œçš„ dispatch å‡½æ•¸</span>
  <span class="token constant">REDUCER_ACTIONS</span><span class="token operator">:</span> ReducerActionType<span class="token punctuation">;</span> <span class="token comment">// è³¼ç‰©è»Šæ“ä½œçš„è¡Œç‚ºé¡å‹</span>
  inCart<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span> <span class="token comment">// ç”¢å“æ˜¯å¦å·²åœ¨è³¼ç‰©è»Šä¸­çš„æ¨™è¨˜</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// Product çµ„ä»¶å®šç¾©</span>
<span class="token keyword">const</span> Product <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
  product<span class="token punctuation">,</span>
  dispatch<span class="token punctuation">,</span>
  <span class="token constant">REDUCER_ACTIONS</span><span class="token punctuation">,</span>
  inCart<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token operator">:</span> PropsType<span class="token punctuation">)</span><span class="token operator">:</span> ReactElement <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ç”¢å“åœ–ç‰‡çš„è·¯å¾‘</span>
  <span class="token keyword">const</span> img<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">../images/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>product<span class="token punctuation">.</span>sku<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">.jpg</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span>url<span class="token punctuation">)</span>
    <span class="token punctuation">.</span>href<span class="token punctuation">;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// æ·»åŠ ç”¢å“åˆ°è³¼ç‰©è»Šçš„äº‹ä»¶è™•ç†å‡½æ•¸</span>
  <span class="token keyword">const</span> <span class="token function-variable function">onAddToCart</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
    <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token constant">REDUCER_ACTIONS</span><span class="token punctuation">.</span><span class="token constant">ADD</span><span class="token punctuation">,</span> payload<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token operator">...</span>product<span class="token punctuation">,</span> qty<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// å¦‚æœç”¢å“å·²åœ¨è³¼ç‰©è»Šä¸­ï¼Œé¡¯ç¤ºæ¨™è¨˜</span>
  <span class="token keyword">const</span> itemInCart <span class="token operator">=</span> inCart <span class="token operator">?</span> <span class="token string">&quot; â†’ Item in Cart: âœ”ï¸&quot;</span> <span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">;</span>

  <span class="token comment">// ç”¢å“çš„å±•ç¤ºå…§å®¹</span>
  <span class="token keyword">const</span> content <span class="token operator">=</span> <span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>article</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>product<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">{</span>product<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>img<span class="token punctuation">}</span></span> <span class="token attr-name">alt</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>product<span class="token punctuation">.</span>name<span class="token punctuation">}</span></span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>product__img<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
        </span><span class="token punctuation">{</span><span class="token keyword">new</span> <span class="token class-name">Intl</span><span class="token punctuation">.</span><span class="token function">NumberFormat</span><span class="token punctuation">(</span><span class="token string">&quot;en-US&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
          style<span class="token operator">:</span> <span class="token string">&quot;currency&quot;</span><span class="token punctuation">,</span>
          currency<span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>product<span class="token punctuation">.</span>price<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token plain-text">
        </span><span class="token punctuation">{</span>itemInCart<span class="token punctuation">}</span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
      </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">onClick</span><span class="token script language-javascript"><span class="token script-punctuation punctuation">=</span><span class="token punctuation">{</span>onAddToCart<span class="token punctuation">}</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">Add to Cart</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
    </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>article</span><span class="token punctuation">&gt;</span></span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> content<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// æ¯”è¼ƒå‡½æ•¸ï¼Œç”¨æ–¼å„ªåŒ–æ€§èƒ½ï¼Œé¿å…ä¸å¿…è¦çš„é‡æ–°æ¸²æŸ“</span>
<span class="token keyword">function</span> <span class="token function">areProductsEqual</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span> product<span class="token operator">:</span> prevProduct<span class="token punctuation">,</span> inCart<span class="token operator">:</span> prevInCart <span class="token punctuation">}</span><span class="token operator">:</span> PropsType<span class="token punctuation">,</span>
  <span class="token punctuation">{</span> product<span class="token operator">:</span> nextProduct<span class="token punctuation">,</span> inCart<span class="token operator">:</span> nextInCart <span class="token punctuation">}</span><span class="token operator">:</span> PropsType
<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>prevProduct<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">every</span><span class="token punctuation">(</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>
        prevProduct<span class="token punctuation">[</span>key <span class="token keyword">as</span> <span class="token keyword">keyof</span> ProductType<span class="token punctuation">]</span> <span class="token operator">===</span>
        nextProduct<span class="token punctuation">[</span>key <span class="token keyword">as</span> <span class="token keyword">keyof</span> ProductType<span class="token punctuation">]</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> prevInCart <span class="token operator">===</span> nextInCart
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// ä½¿ç”¨ memo åŒ…è£ Product çµ„ä»¶ï¼Œå„ªåŒ–æ¸²æŸ“æ€§èƒ½</span>
<span class="token keyword">const</span> MemoizedProduct <span class="token operator">=</span> <span class="token generic-function"><span class="token function">memo</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token keyword">typeof</span> Product<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span>Product<span class="token punctuation">,</span> areProductsEqual<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> MemoizedProduct<span class="token punctuation">;</span>
</code></pre></div><h2 id="ãƒˆãƒ©ãƒ•ã‚™ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚¯ã‚™"><a href="#ãƒˆãƒ©ãƒ•ã‚™ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚¯ã‚™" class="header-anchor">#</a> ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</h2> <h3 id="â–«ï¸-usecartcontext-hooks"><a href="#â–«ï¸-usecartcontext-hooks" class="header-anchor">#</a> â–«ï¸ useCartContext hooks</h3> <blockquote><p>é€™æ®µä»£ç¢¼å®šä¹‰äº†ä¸€ä¸ªåä¸º <code>useCartContext</code> çš„è‡ªå®šä¹‰ React Hookã€‚è¿™ä¸ª Hook ä½¿ç”¨äº† React çš„å‡ ä¸ªå†…ç½®åŠŸèƒ½ï¼Œå¦‚ <code>useReducer</code> å’Œ <code>useMemo</code>ï¼Œæ¥ç®¡ç†å’Œä¼˜åŒ–è´­ç‰©è½¦åº”ç”¨çš„çŠ¶æ€ã€‚ä¸‹é¢æ˜¯å¯¹æ¯ä¸ªéƒ¨åˆ†çš„è¯¦ç»†è§£é‡Šï¼š</p></blockquote> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">const</span> <span class="token function-variable function">useCartContext</span> <span class="token operator">=</span> <span class="token punctuation">(</span>initialCartState<span class="token operator">:</span> CartStateType<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> initialCartState<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">//useMemo ä¸»è¦ç”¨äºç¼“å­˜è®¡ç®—ç»“æœï¼Œå¹¶åœ¨ä¾èµ–é¡¹ï¼ˆdependenciesï¼‰å‘ç”Ÿå˜åŒ–æ—¶é‡æ–°è®¡ç®—ã€‚</span>
  <span class="token keyword">const</span> <span class="token constant">REDUCER_ACTIONS</span> <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token constant">REDUCER_ACTION_TYPE</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> totalItems <span class="token operator">=</span> state<span class="token punctuation">.</span>cart<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>previousValue<span class="token punctuation">,</span> cartItem<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> previousValue <span class="token operator">+</span> cartItem<span class="token punctuation">.</span>qty<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> totalPrice <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl</span><span class="token punctuation">.</span><span class="token function">NumberFormat</span><span class="token punctuation">(</span><span class="token string">&quot;en-US&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    style<span class="token operator">:</span> <span class="token string">&quot;currency&quot;</span><span class="token punctuation">,</span>
    currency<span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>
    state<span class="token punctuation">.</span>cart<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>previousValue<span class="token punctuation">,</span> cartItem<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> previousValue <span class="token operator">+</span> cartItem<span class="token punctuation">.</span>qty <span class="token operator">*</span> cartItem<span class="token punctuation">.</span>price<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// è¿™æ®µä»£ç çš„ä½œç”¨æ˜¯å¯¹è´­ç‰©è½¦ä¸­çš„å•†å“è¿›è¡Œæ’åºï¼Œæ’åºçš„è§„åˆ™æ˜¯æŒ‰ç…§å•†å“çš„ sku å±æ€§çš„åå››ä½æ•°å­—è¿›è¡Œå‡åºæ’åºã€‚</span>
  <span class="token keyword">const</span> cart <span class="token operator">=</span> state<span class="token punctuation">.</span>cart<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">//åˆ†åˆ«æå–äº†å•†å“ a å’Œ b çš„ sku å±æ€§çš„åå››ä½æ•°å­—éƒ¨åˆ†ã€‚è¿™äº›æ•°å­—ä¼šè¢«è½¬æ¢æˆæ•°å€¼ç±»å‹ã€‚</span>
    <span class="token keyword">const</span> itemA <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>sku<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> itemB <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>sku<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è¡¨ç¤ºæ ¹æ®æå–å‡ºçš„æ•°å­—è¿›è¡Œå‡åºæ’åºï¼Œå³å¦‚æœ itemA å°äº itemBï¼Œè¿”å›è´Ÿæ•°ï¼›å¦‚æœ itemA ç­‰äº itemBï¼Œè¿”å›é›¶ï¼›å¦‚æœ itemA å¤§äº itemBï¼Œè¿”å›æ­£æ•°ã€‚</span>
    <span class="token keyword">return</span> itemA <span class="token operator">-</span> itemB<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token punctuation">{</span> dispatch<span class="token punctuation">,</span> <span class="token constant">REDUCER_ACTIONS</span><span class="token punctuation">,</span> totalPrice<span class="token punctuation">,</span> totalItems<span class="token punctuation">,</span> cart <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>useReducer</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span> dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> initialCartState<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>è¿™é‡Œä½¿ç”¨äº† <code>useReducer</code> Hook æ¥ç®¡ç†è´­ç‰©è½¦çš„çŠ¶æ€ã€‚<code>useReducer</code> æ˜¯ä¸€ä¸ªæ›¿ä»£ <code>useState</code> çš„ Hookï¼Œé€‚ç”¨äºå¤æ‚çš„çŠ¶æ€é€»è¾‘ï¼Œå¯ä»¥è®©ä½ æ ¹æ® action æ›´æ–°çŠ¶æ€ã€‚</li> <li><code>reducer</code> æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå®šä¹‰äº†çŠ¶æ€å¦‚ä½•å“åº”ä¸åŒçš„ action ç±»å‹ã€‚</li> <li><code>initialCartState</code> æ˜¯è´­ç‰©è½¦çš„åˆå§‹çŠ¶æ€ã€‚</li> <li><code>state</code> ä»£è¡¨å½“å‰çš„çŠ¶æ€ï¼Œ<code>dispatch</code> æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œç”¨æ¥å‘é€ action åˆ° reducerã€‚</li></ul> <blockquote><p>useMemo</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> <span class="token constant">REDUCER_ACTIONS</span> <span class="token operator">=</span> <span class="token function">useMemo</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token constant">REDUCER_ACTION_TYPE</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><code>useMemo</code> ç”¨äºç¼“å­˜è®¡ç®—çš„ç»“æœã€‚è¿™é‡Œå®ƒè¢«ç”¨æ¥ç¼“å­˜ <code>REDUCER_ACTION_TYPE</code> å¯¹è±¡ã€‚</li> <li>ä¾èµ–é¡¹æ•°ç»„ï¼ˆ<code>[]</code>ï¼‰ä¸ºç©ºï¼Œè¿™æ„å‘³ç€ <code>REDUCER_ACTIONS</code> åªä¼šåœ¨ç»„ä»¶é¦–æ¬¡æ¸²æŸ“æ—¶è®¡ç®—ä¸€æ¬¡ã€‚</li></ul> <blockquote><p>è®¡ç®—æ€»æ•°å’Œæ€»ä»·</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> totalItems <span class="token operator">=</span> state<span class="token punctuation">.</span>cart<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>previousValue<span class="token punctuation">,</span> cartItem<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> previousValue <span class="token operator">+</span> cartItem<span class="token punctuation">.</span>qty<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> totalPrice <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Intl</span><span class="token punctuation">.</span><span class="token function">NumberFormat</span><span class="token punctuation">(</span><span class="token string">&quot;en-US&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  style<span class="token operator">:</span> <span class="token string">&quot;currency&quot;</span><span class="token punctuation">,</span>
  currency<span class="token operator">:</span> <span class="token string">&quot;USD&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>
  state<span class="token punctuation">.</span>cart<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token punctuation">(</span>previousValue<span class="token punctuation">,</span> cartItem<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> previousValue <span class="token operator">+</span> cartItem<span class="token punctuation">.</span>qty <span class="token operator">*</span> cartItem<span class="token punctuation">.</span>price<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>è¿™ä¸¤ä¸ªå˜é‡ä½¿ç”¨ <code>reduce</code> æ–¹æ³•æ¥è®¡ç®—è´­ç‰©è½¦ä¸­å•†å“çš„æ€»æ•°é‡ (<code>totalItems</code>) å’Œæ€»ä»· (<code>totalPrice</code>)ã€‚</li></ul> <blockquote><p>å¯¹è´­ç‰©è½¦å•†å“è¿›è¡Œæ’åº</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">const</span> cart <span class="token operator">=</span> state<span class="token punctuation">.</span>cart<span class="token punctuation">.</span><span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> itemA <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>sku<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> itemB <span class="token operator">=</span> <span class="token function">Number</span><span class="token punctuation">(</span>b<span class="token punctuation">.</span>sku<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> itemA <span class="token operator">-</span> itemB<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ul><li>è¿™æ®µä»£ç å¯¹è´­ç‰©è½¦ä¸­çš„å•†å“æ ¹æ® <code>sku</code> çš„åå››ä½æ•°å­—è¿›è¡Œå‡åºæ’åºã€‚</li></ul> <blockquote><p>è¿”å›å€¼</p></blockquote> <div class="language-typescript extra-class"><pre class="language-typescript"><code><span class="token keyword">return</span> <span class="token punctuation">{</span> dispatch<span class="token punctuation">,</span> <span class="token constant">REDUCER_ACTIONS</span><span class="token punctuation">,</span> totalPrice<span class="token punctuation">,</span> totalItems<span class="token punctuation">,</span> cart <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><ul><li><code>useCartContext</code> è¿”å›ä¸€ä¸ªåŒ…å« <code>dispatch</code> å‡½æ•°ã€åŠ¨ä½œç±»å‹ (<code>REDUCER_ACTIONS</code>)ã€è´­ç‰©è½¦æ€»ä»· (<code>totalPrice</code>)ã€æ€»æ•°é‡ (<code>totalItems</code>) å’Œæ’åºåçš„è´­ç‰©è½¦å•†å“åˆ—è¡¨ (<code>cart</code>) çš„å¯¹è±¡ã€‚</li> <li>è¿™ä¸ª Hook å¯ä»¥è¢«ç”¨äºç»„ä»¶ä¸­ï¼Œä»¥ä¾¿äºè®¿é—®å’Œæ“ä½œè´­ç‰©è½¦çš„çŠ¶æ€ã€‚</li></ul> <p>æ€»çš„æ¥è¯´ï¼Œ<code>useCartContext</code> Hook ä¸ºè´­ç‰©è½¦åº”ç”¨æä¾›äº†ä¸€ä¸ªé›†ä¸­çš„çŠ¶æ€ç®¡ç†æ–¹æ¡ˆï¼Œä½¿å¾—çŠ¶æ€çš„è¯»å–å’Œæ›´æ–°æ›´åŠ æ–¹ä¾¿å’Œé«˜æ•ˆã€‚</p> <h3 id="â–«ï¸-usecartcontexttype"><a href="#â–«ï¸-usecartcontexttype" class="header-anchor">#</a> â–«ï¸ UseCartContextType</h3> <blockquote><p>åœ¨ TypeScript ä¸­å®šä¹‰ <code>UseCartContextType</code> ç±»å‹ä½œä¸º <code>ReturnType&lt;typeof useCartContext&gt;</code> çš„åŸå› æ˜¯ä¸ºäº†ç¡®ä¿ç±»å‹å®‰å…¨å’Œä»£ç çš„æ¸…æ™°æ€§ã€‚è¿™é‡Œè§£é‡Šä¸€ä¸‹å…·ä½“åŸå› å’Œç”¨é€”ï¼š</p></blockquote> <div class="language-tsx extra-class"><pre class="language-tsx"><code><span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">UseCartContextType</span> <span class="token operator">=</span> ReturnType<span class="token operator">&lt;</span><span class="token keyword">typeof</span> useCartContext<span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>ä¸ºä»€ä¹ˆè¦ç¡®å®šè¿”å›å€¼çš„ç±»å‹</p></blockquote> <ol><li><strong>ç±»å‹å®‰å…¨</strong>:</li></ol> <ul><li>TypeScript å¼ºç±»å‹ç³»ç»Ÿçš„ä¸€ä¸ªä¸»è¦ä¼˜ç‚¹æ˜¯å®ƒæä¾›äº†ç±»å‹å®‰å…¨ã€‚é€šè¿‡æ˜ç¡®æŒ‡å®šå‡½æ•°è¿”å›å€¼çš„ç±»å‹ï¼Œä½ å¯ä»¥åœ¨ç¼–è¯‘æ—¶æ•æ‰æ½œåœ¨çš„é”™è¯¯ï¼Œè€Œä¸æ˜¯åœ¨è¿è¡Œæ—¶ã€‚</li> <li>åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œ<code>useCartContext</code> æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰ Hookï¼Œå®ƒå¯èƒ½è¿”å›ä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ï¼ŒåŒ…å«å¤šä¸ªå±æ€§å’Œæ–¹æ³•ã€‚ä½¿ç”¨ <code>ReturnType</code> å¯ä»¥ç¡®ä¿ä½ å®Œå…¨ç†è§£å¹¶æ­£ç¡®å¤„ç†è¿™ä¸ª Hook è¿”å›çš„æ•°æ®ç»“æ„ã€‚</li></ul> <ol start="2"><li><strong>è‡ªåŠ¨æ¨æ–­</strong>:</li></ol> <ul><li><code>ReturnType&lt;typeof useCartContext&gt;</code> è‡ªåŠ¨æ¨æ–­ <code>useCartContext</code> Hook çš„è¿”å›å€¼ç±»å‹ã€‚è¿™æ„å‘³ç€å¦‚æœ <code>useCartContext</code> çš„å®ç°æ›´æ”¹äº†è¿”å›å€¼çš„ç»“æ„ï¼Œ<code>UseCartContextType</code> ä¹Ÿä¼šç›¸åº”åœ°æ›´æ–°ï¼Œæ— éœ€æ‰‹åŠ¨æ›´æ”¹ã€‚</li></ul> <blockquote><p>è¿”å›å€¼æ˜¯ä»€ä¹ˆ</p></blockquote> <ul><li><strong>è¿”å›å€¼</strong>:</li> <li><code>useCartContext</code> Hook çš„è¿”å›å€¼æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«äº†ä¸è´­ç‰©è½¦ç›¸å…³çš„æ•°æ®å’Œå‡½æ•°ã€‚è¿™é€šå¸¸åŒ…æ‹¬è´­ç‰©è½¦çš„çŠ¶æ€ï¼ˆå¦‚å•†å“åˆ—è¡¨ã€æ€»ä»·ç­‰ï¼‰ä»¥åŠç”¨äºæ›´æ–°è¿™äº›çŠ¶æ€çš„æ–¹æ³•ï¼ˆå¦‚ dispatch æ–¹æ³•ï¼‰ã€‚</li></ul> <blockquote><p>åœ¨ä»€ä¹ˆåœ°æ–¹ç”¨</p></blockquote> <ol><li><strong>åœ¨ Context æä¾›è€…ä¸­</strong>:</li></ol> <ul><li>å½“ä½ åˆ›å»ºä¸€ä¸ª Context å¹¶ä¸”æƒ³è¦åœ¨æ•´ä¸ªåº”ç”¨ä¸­å…±äº« <code>useCartContext</code> æä¾›çš„æ•°æ®å’Œå‡½æ•°æ—¶ï¼Œå¯ä»¥ä½¿ç”¨è¿™ä¸ªç±»å‹ã€‚ä¾‹å¦‚ï¼Œåœ¨ <code>CartProvider</code> ç»„ä»¶ä¸­ï¼Œä½ å¯èƒ½ä¼šå°† <code>useCartContext</code> çš„è¿”å›å€¼ä½œä¸º Context çš„å€¼ã€‚</li></ul> <ol start="2"><li><strong>åœ¨æ¶ˆè´¹è€…ç»„ä»¶ä¸­</strong>:</li></ol> <ul><li>ç»„ä»¶å¯ä»¥é€šè¿‡ <code>useContext(CartContext)</code> ä½¿ç”¨è¿™ä¸ªç±»å‹æ¥è®¿é—®è´­ç‰©è½¦çš„æ•°æ®å’Œæ“ä½œå‡½æ•°ã€‚è¿™æ ·å¯ä»¥ç¡®ä¿ç»„ä»¶æ­£ç¡®åœ°ä½¿ç”¨äº† Context æä¾›çš„æ•°æ®ï¼ŒåŒæ—¶ä¹Ÿäº«å—åˆ°äº† TypeScript çš„ç±»å‹æ£€æŸ¥å’Œè‡ªåŠ¨å®Œæˆçš„å¥½å¤„ã€‚</li></ul> <p>æ€»ä¹‹ï¼Œ<code>UseCartContextType</code> çš„å®šä¹‰å’Œä½¿ç”¨ä½¿å¾—ä½ çš„ React ç»„ä»¶å¯ä»¥é«˜æ•ˆä¸”å®‰å…¨åœ°ä¸è´­ç‰©è½¦ç›¸å…³çš„çŠ¶æ€å’Œæ“ä½œè¿›è¡Œäº¤äº’ï¼ŒåŒæ—¶ä¿æŒä»£ç çš„æ¸…æ™°å’Œå¯ç»´æŠ¤æ€§ã€‚</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/practice/todolist.html" class="prev">
        TodoList App
      </a></span> <span class="next"><a href="/practice/github.html">
        /practice/github.html
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.204ed3d4.js" defer></script><script src="/assets/js/2.a44fb3b0.js" defer></script><script src="/assets/js/1.8d37d391.js" defer></script><script src="/assets/js/55.a4b8b234.js" defer></script>
  </body>
</html>
